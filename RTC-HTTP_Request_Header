$tenantId = "common"  # or your specific tenant
$clientId = "your_client_id"  # often from a known client like Azure CLI
$refreshToken = "your_refresh_token"
$resource = "https://management.core.windows.net/"  # or Graph

$body = @{
    grant_type    = 'refresh_token'
    refresh_token = $refreshToken
    client_id     = $clientId
    resource      = $resource
}

$response = Invoke-RestMethod -Method POST -Uri "https://login.microsoftonline.com/$tenantId/oauth2/token" -Body $body -ContentType "application/x-www-form-urlencoded"
$response.access_token
